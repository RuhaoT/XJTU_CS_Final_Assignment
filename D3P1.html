<!DOCTYPE html>
<html>  
  <head>  
        <meta charset="utf-8">  
        <title>力导向图</title>  
        <style>
            html {
                margin: 0px;
                border: 0px;
            }
            body {
                background-color: #EEEEEE;
            }
            .links line {
              stroke: #999;
              stroke-opacity: 0.6;
            }
            
            .nodes circle {
              stroke: #fff;
              stroke-width: 1.5px;
            }
            
            </style>
    
  </head> 

    <body>  
        <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>  
        <script>           
                       
        var nodes = [
            { name: "计算机学科课程",group:6    },
                { name: "大类平台课程",group:5    },
                    { name: "工程与社会",group:4  },
                    { name: "数据结构与算法",group:4  },
                    { name: "电路",group:4  },
                        { name: "电路实验",group:3  },
                        { name: "模拟电子技术",group:3  },
                        { name: "数字逻辑电路",group:3  },
                    { name: "大学物理",group:4  },
                    { name: "概率统计与随机过程",group:4  },
                    { name: "数学建模与优化方法",group:4  },
                { name: "专业课程",group:5    },
                    { name: "计算机科学技术导论",group:4  },
                    { name: "计算机组成",group:4  },
                        { name: "计算机接口技术",group:3  },
                    { name: "操作系统原理",group:4  },
                    { name: "形式语言与编译",group:4  },
                        { name: "汇编语言",group:3  },
                    { name: "计算机网络原理",group:4  },
                        { name: "网络与信息安全",group:3  },
                        { name: "软件定义网络",group:3  },
                        { name: "物联网应用概论",group:3  },
                        { name: "信息系统设计",group:3  },                        
                        { name: "移动计算与服务",group:3  },
                    { name: "数据库系统",group:4  },
                        { name: "数据仓库与数据挖掘",group:3  },
                        { name: "大数据分析系统",group:3  },         
                        { name: "算法设计与分析",group:3  },
                    { name: "自动控制原理",group:4  },
                    { name: "嵌入式智能系统",group:4  },
                    { name: "认知计算与机器学习",group:4  },
                    { name: "网络与信息安全",group:4  },
                    { name: "面向对象程序设计",group:4  },
                        { name: "软件工程",group:3  },
                        { name: "JAVA语言程序设计",group:3  },
                        { name: "计算机动画和科学可视化",group:3  },
                        { name: "并行优化和平面设计",group:3  },
                    { name: "数理逻辑",group:4  },
                    { name: "组合数学",group:4  },
                    { name: "计算机体系结构",group:4  },
                    { name: "计算机图形学",group:4  },
                        { name: "数字图像处理与压缩编码技术",group:3  },
                    { name: "电子系统设计",group:4  },
                    { name: "计算机视觉与模式识别",group:4  },
                        { name: "人工智能",group:3  },
                        { name: "自然语言基础",group:3  },       
                    { name: "大规模集成电路设计基础",group:4  },
                    { name: "信号与系统",group:4  },
                    { name: "通信原理",group:4  },
                    { name: "数字信号处理",group:4  },

            { name: "数学和基础科学类课程",group:6    },
                                    { name: "大学计算机",group:4  },
                                    { name: "高等数学",group:4  },
                                    { name: "程序设计基础",group:4  },
                                    { name: "线性代数与解析几何",group:4  },
            
                    { name: "离散数学",group:4  },
                                ];
                     
        var edges = [ 
             { source : 0  , target: 1 } , 
             { source : 1  , target: 2 } ,
             { source : 1  , target: 3 } , 
             { source : 1  , target: 4 } , 
             { source : 4  , target: 5 } ,  
             { source : 4  , target: 6 } , 
             { source : 4  , target: 7 } , 
             { source : 1  , target: 8 } , 
             { source : 1  , target: 9 } , 
             { source : 1  , target: 10 } , 
             { source : 0  , target: 11 } , 
             { source : 11  , target: 12 } , 
             { source : 11  , target: 13 } , 
             { source : 13  , target: 14 } , 
             { source : 11  , target: 15 } , 
             { source : 11  , target: 16 } ,             
             { source : 16  , target: 17 } , 
             { source : 11  , target: 18 } , 
             { source : 18  , target: 19 } , 
             { source : 18  , target: 20 } ,   
             { source : 18  , target: 21 } , 
             { source : 18  , target: 22 } , 
             { source : 18  , target: 23 } , 
             { source : 11  , target: 24 } ,
             { source : 24  , target: 25 } , 
             { source : 24  , target: 26 } , 
             { source : 24  , target: 27 } , 
             { source : 11  , target: 28 } ,
             { source : 11 , target: 29 } ,
             { source : 11  , target: 30 } ,
             { source : 11  , target: 31 } ,
             { source : 11  , target: 32 } ,
             { source : 32  , target: 33 } ,
             { source : 32  , target: 34 } ,
             { source : 32  , target: 35 } ,
             { source : 32  , target: 36 } ,
             { source : 11  , target: 37 } ,
             { source : 11  , target: 38 } ,
             { source : 11  , target: 39 } ,
             { source : 11  , target: 40 } ,
             { source : 40  , target: 41 } ,
             { source : 11  , target: 42 } ,
             { source : 11  , target: 43 } ,
             { source : 43  , target: 44 } ,
             { source : 43  , target: 45 } ,
             { source : 11  , target: 46 } ,
             { source : 11  , target: 47 } ,
             { source : 11  , target: 48 } ,
             { source : 11  , target: 49 } ,

             { source : 50  , target: 51 } ,
             { source : 50  , target: 52 } ,
             { source : 50  , target: 53 } ,
             { source : 50  , target: 54 } ,

             { source : 1  , target: 55 } ,
             { source : 55  , target: 37 } ,
             { source : 55  , target: 38 } ,
             { source : 54  , target: 55 } ,
             { source : 52  , target: 9 } ,
             { source : 52  , target: 10 } ,
                            ];    
        
        var width = 1400;
        var height =900;
        
        
        var svg = d3.select("body")
                    .append("svg")
                    .attr("width",width)
                    .attr("height",height);
        
        var force = d3.layout.force()
                .nodes(nodes)        //指定节点数组
                .links(edges)        //指定连线数组
                .size([width,height])    //指定范围
                .linkDistance(150)    //指定连线长度
                .charge(-400);    //相互之间的作用力

        force.start();    //开始作用

        console.log(nodes);
        console.log(edges);
        
        //添加连线        
        var svg_edges = svg.selectAll("line")
                            .data(edges)
                            .attr("class", "links")
                            .enter()
                            .append("line")
                            .style("stroke","#ccc")
                            .style("stroke-width",2)
                            .style("stroke-opacity",0.7);
        
        var color = d3.scale.category20();
                
        //添加节点            
        var svg_nodes = svg.selectAll("circle")
                            .data(nodes)
                            .attr("class", "nodes")
                            .enter()
                            .append("circle")
                            .attr("r",function(d){return d.group * 4} )
                            .style("fill",function(d,i){
                                return color(d.group);
                            })
                            .call(force.drag);    //使得节点能够拖动

        //添加描述节点的文字
        var svg_texts = svg.selectAll("text")
                            .data(nodes)
                            .enter()
                            .append("text")
                            .style("fill", "black")
                            .attr("dx", function(d){return d.group * 8})
                            .attr("dy", 8)
                            .text(function(d){
                                return d.name;
                            });
                    

        force.on("tick", function(){    //对于每一个时间间隔
        
             //更新连线坐标
             svg_edges.attr("x1",function(d){ return d.source.x; })
                     .attr("y1",function(d){ return d.source.y; })
                     .attr("x2",function(d){ return d.target.x; })
                     .attr("y2",function(d){ return d.target.y; });
             
             //更新节点坐标
             svg_nodes.attr("cx",function(d){ return d.x; })
                     .attr("cy",function(d){ return d.y; });

             //更新文字坐标
             svg_texts.attr("x", function(d){ return d.x; })
                 .attr("y", function(d){ return d.y; });
        });
          
        </script>  
        
    </body>  
</html>
